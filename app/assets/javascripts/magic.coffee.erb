ready = ->

  toggleNav = ->
    if $('.navigation').hasClass('show')
      # Do things on Nav Close
      $('.navgation').removeClass 'show'
     
    else
      # Do things on Nav Open
      $('.navigation').addClass 'show'
      $('#jquery_jplayer_menu').jPlayer('play');
    return

  switchVideo = (section) ->
    switch section
      when "home"
        videomp4 = "<%= asset_path('intro.mp4') %>"
        videowebm = "<%= asset_path('intro.webm') %>"
        videom4v = "<%= asset_path('intro.m4v') %>"
        videojpg = "<%= asset_path('intro.jpg') %>"
        $('#jquery_jplayer_1').jPlayer
          ready: ->
            $(this).jPlayer('setMedia',
              mp4: videomp4
              webmv: videowebm
              m4v: videom4v
              poster: videojpg).jPlayer 'play'
            return
          swfPath: '/js'
          supplied: 'webmv, mp4, m4v'
          loop: true
          muted: true

        $('#jquery_jplayer_1').bind $.jPlayer.event.ended, (event) ->
          $('.toggle-nav').click()
          $('#jquery_jplayer_menu').jPlayer 'play'
          return

      when "collections"
        videomp4 = "<%= asset_path('collections.mp4') %>"
        videowebm = "<%= asset_path('collections.webm') %>"
        videom4v = "<%= asset_path('collections.m4v') %>"
        videojpg = "<%= asset_path('collections.jpg') %>"
        $('#jquery_jplayer_1').jPlayer
          ready: ->
            $(this).jPlayer('setMedia',
              mp4: videomp4
              webmv: videowebm
              m4v: videom4v
              poster: videojpg).jPlayer 'play'
            return
          swfPath: '/js'
          supplied: 'webmv, mp4, m4v'
          loop: true
          muted: true

      when "stylings"
        videomp4 = "<%= asset_path('stylings.mp4') %>"
        videowebm = "<%= asset_path('stylings.webm') %>"
        videom4v = "<%= asset_path('stylings.m4v') %>"
        videojpg = "<%= asset_path('stylings.jpg') %>"
        $('#jquery_jplayer_1').jPlayer
          ready: ->
            $(this).jPlayer('setMedia',
              mp4: videomp4
              webmv: videowebm
              m4v: videom4v
              poster: videojpg).jPlayer 'play'
            return
          swfPath: '/js'
          supplied: 'webmv, mp4, m4v'
          loop: true
          muted: true

      when "interiors"
        videomp4 = "<%= asset_path('interior.mp4') %>"
        videowebm = "<%= asset_path('interior.webm') %>"
        videom4v = "<%= asset_path('interior.m4v') %>"
        videojpg = "<%= asset_path('interiors.jpg') %>"
        $('#jquery_jplayer_1').jPlayer
          ready: ->
            $(this).jPlayer('setMedia',
              mp4: videomp4
              webmv: videowebm
              m4v: videom4v
              poster: videojpg).jPlayer 'play'
            return
          swfPath: '/js'
          supplied: 'webmv, mp4, m4v'
          loop: true
          muted: true

      when "releases"
        videomp4 = "<%= asset_path('releases.mp4') %>"
        videowebm = "<%= asset_path('releases.webm') %>"
        videom4v = "<%= asset_path('releases.m4v') %>"
        videojpg = "<%= asset_path('releases.jpg') %>"
        $('#jquery_jplayer_1').jPlayer
          ready: ->
            $(this).jPlayer('setMedia',
              mp4: videomp4
              webmv: videowebm
              m4v: videom4v
              poster: videojpg).jPlayer 'play'
            return
          swfPath: '/js'
          supplied: 'webmv, mp4, m4v'
          loop: true
          muted: true
          
    return    

  menuAnimation = ->
    menuvideomp4 = "<%= asset_path('menu.mp4') %>"
    menuvideowebm = "<%= asset_path('menu.webm') %>"
    menuvideom4v = "<%= asset_path('menu.m4v') %>"
    menuvideojpg = "<%= asset_path('menu.jpg') %>"
    $('#jquery_jplayer_menu').jPlayer
      ready: ->
        $(this).jPlayer('setMedia',
          m4v: menuvideomp4
          webmv: menuvideowebm
          m4v: menuvideom4v
          poster: menuvideojpg)
        return
      swfPath: '/js'
      supplied: 'webmv, mp4, m4v'
      loop: true
      muted: true

  $ ->
    section = $('body').attr('id')
    switchVideo(section)
    menuAnimation()
    Turbolinks.pagesCached(0)

    $(document).on 'page:change', ->
      $('#primary-content').addClass 'animated'
      $('#primary-content').addClass 'fadeInUp'

      return
    $(document).on 'page:fetch', ->
      $('#primary-content').addClass 'animated'
      $('#primary-content').addClass 'fadeOutUp'
      $('.sc-player.playing a.sc-pause').click()
      return

    $(document).on 'page:restore', ->
      $('#primary-content').addClass 'animated'
      $('#primary-content').removeClass 'fadeOutUp'
      $('#primary-content').addClass 'fadeInUp'
      return

    # Toggle Nav on Click
    $('.toggle-nav').click (event) ->
      # Calling a function in case you want to expand upon this.
      event.preventDefault()
      toggleNav()
      return
    return
    
    
$(document).ready(ready);
$(document).on('page:load', ready);
